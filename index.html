<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pigeon Race Results</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; }
    h1 { font-size: 2.5em; margin: 20px 0; }
    h2 { font-size: 1.5em; margin: 10px 0; }
    .tabs { display: flex; justify-content: center; gap: 20px; margin-top: 20px; }
    .tab { padding: 10px 20px; cursor: pointer; }
    .tab.active { color: white; background-color: green; }
    .results-table { width: 100%; margin-top: 20px; border-collapse: collapse; }
    .results-table th, .results-table td { border: 1px solid #ddd; padding: 8px; }
    #search { padding: 10px; width: 250px; font-size: 1em; margin-top: 20px; }
    #dateToday { font-size: 1em; margin-top: 20px; }
  </style>
</head>
<body>

  <!-- Header -->
  <h1>BBC Cavite - Laguna</h1>
  <h2>Unofficial Race Results</h2>
  <p id="dateToday"></p>

  <!-- Tabs -->
  <div class="tabs">
    <div class="tab" onclick="loadRaceData('OC300')">OC300</div>
    <div class="tab" onclick="loadRaceData('KO200_6L')">KO200 6 Laps</div>
    <div class="tab" onclick="loadRaceData('KO500_6L')">KO500 6 Laps</div>
    <div class="tab" onclick="loadRaceData('KO1K_6L')">KO1K 6 Laps</div>
    <div class="tab" onclick="loadRaceData('KO2K_6L')">KO2K 6 Laps</div>
    <div class="tab" onclick="loadRaceData('70K')">70K 5 Laps</div>
    <div class="tab" onclick="loadRaceData('KO200_5L')">KO200 5 Laps</div>
    <div class="tab" onclick="loadRaceData('KO500_5L')">KO500 5 Laps</div>
    <div class="tab" onclick="loadRaceData('KO1K_5L')">KO1K 5 Laps</div>
  </div>

  <!-- Search bar -->
  <input type="text" id="search" placeholder="Search..." oninput="filterResults()" style="margin-top: 20px;">

  <!-- Results table -->
  <table class="results-table" id="resultsTable">
    <thead id="tableHeader">
      <!-- Table headers will be dynamically inserted here -->
    </thead>
    <tbody id="resultsBody">
      <!-- Results will be loaded here -->
    </tbody>
  </table>

  <script>
    const apiKey = 'AIzaSyDnQPBVIY-hChWThux9R8WknqvuDHsDFog';  // Replace with your actual Google Sheets API key
    const raceDataUrls = {
      OC300: 'https://sheets.googleapis.com/v4/spreadsheets/1FrRKiQzuPzrgwFWnt7su79v77A8l5w9FQzU0S0bU8rQ/values/OC300!A3:J83?key=' + apiKey,
      KO200_6L: 'https://sheets.googleapis.com/v4/spreadsheets/1FrRKiQzuPzrgwFWnt7su79v77A8l5w9FQzU0S0bU8rQ/values/KO200!A3:J83?key=' + apiKey,
      KO500_6L: 'https://sheets.googleapis.com/v4/spreadsheets/1FrRKiQzuPzrgwFWnt7su79v77A8l5w9FQzU0S0bU8rQ/values/KO500!A3:J44?key=' + apiKey,
      KO1K_6L: 'https://sheets.googleapis.com/v4/spreadsheets/1FrRKiQzuPzrgwFWnt7su79v77A8l5w9FQzU0S0bU8rQ/values/KO1K!A3:J14?key=' + apiKey,
      KO2K_6L: 'https://sheets.googleapis.com/v4/spreadsheets/1FrRKiQzuPzrgwFWnt7su79v77A8l5w9FQzU0S0bU8rQ/values/KO2K!A3:J5?key=' + apiKey,
      '70K': 'https://sheets.googleapis.com/v4/spreadsheets/1sYMtpbNYTprx2INESiuwIVU8aIb9Ng1lHr38Y3MUduo/values/70K!A3:I437?key=' + apiKey,
      KO200_5L: 'https://sheets.googleapis.com/v4/spreadsheets/1sYMtpbNYTprx2INESiuwIVU8aIb9Ng1lHr38Y3MUduo/values/KO200!A3:I79?key=' + apiKey,
      KO500_5L: 'https://sheets.googleapis.com/v4/spreadsheets/1sYMtpbNYTprx2INESiuwIVU8aIb9Ng1lHr38Y3MUduo/values/KO500!A3:I16?key=' + apiKey,
      KO1K_5L: 'https://sheets.googleapis.com/v4/spreadsheets/1sYMtpbNYTprx2INESiuwIVU8aIb9Ng1lHr38Y3MUduo/values/KO1K!A3:I8?key=' + apiKey,
    };

    const tableHeaders = {
      OC300: ['Rank', 'Player Name', 'Pigeon ID', 'Lap 1', 'Lap 2', 'Lap 3', 'Lap 4', 'Lap 5', 'Lap 6', 'Total Speed'],
      KO200_6L: ['Rank', 'Player Name', 'Pigeon ID', 'Lap 1', 'Lap 2', 'Lap 3', 'Lap 4', 'Lap 5', 'Lap 6', 'Total Speed'],
      KO500_6L: ['Rank', 'Player Name', 'Pigeon ID', 'Lap 1', 'Lap 2', 'Lap 3', 'Lap 4', 'Lap 5', 'Lap 6', 'Total Speed'],
      KO1K_6L: ['Rank', 'Player Name', 'Pigeon ID', 'Lap 1', 'Lap 2', 'Lap 3', 'Lap 4', 'Lap 5', 'Lap 6', 'Total Speed'],
      KO2K_6L: ['Rank', 'Player Name', 'Pigeon ID', 'Lap 1', 'Lap 2', 'Lap 3', 'Lap 4', 'Lap 5', 'Lap 6', 'Total Speed'],
      '70K': ['Rank', 'Player Name', 'Pigeon ID', 'Lap 1', 'Lap 2', 'Lap 3', 'Lap 4', 'Lap 5', 'Total Speed'],
      KO200_5L: ['Rank', 'Player Name', 'Pigeon ID', 'Lap 1', 'Lap 2', 'Lap 3', 'Lap 4', 'Lap 5', 'Total Speed'],
      KO500_5L: ['Rank', 'Player Name', 'Pigeon ID', 'Lap 1', 'Lap 2', 'Lap 3', 'Lap 4', 'Lap 5', 'Total Speed'],
      KO1K_5L: ['Rank', 'Player Name', 'Pigeon ID', 'Lap 1', 'Lap 2', 'Lap 3', 'Lap 4', 'Lap 5', 'Total Speed'],
    };

    function loadRaceData(race) {
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      document.querySelector(`.tab[onclick="loadRaceData('${race}')"]`).classList.add('active');

      const headers = tableHeaders[race];
      document.getElementById('tableHeader').innerHTML = `<tr>${headers.map(header => `<th>${header}</th>`).join('')}</tr>`;

      fetch(raceDataUrls[race])
        .then(response => response.json())
        .then(data => {
          const rows = data.values.map(row => {
            return `<tr>${row.map(cell => `<td>${cell}</td>`).join('')}</tr>`;
          }).join('');
          document.getElementById('resultsBody').innerHTML = rows;
          
          updateDate();
        })
        .catch(error => console.error('Error loading race data:', error));
    }

    function filterResults() {
      const query = document.getElementById('search').value.toLowerCase();
      const rows = document.querySelectorAll('#resultsBody tr');
      rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        let match = false;
        cells.forEach(cell => {
          if (cell.textContent.toLowerCase().includes(query)) {
            match = true;
          }
        });
        row.style.display = match ? '' : 'none';
      });
    }

    function updateDate() {
      const date = new Date();
      const options = { year: 'numeric', month: 'long', day: 'numeric' };
      const dateString = date.toLocaleString('en-US', options);
      document.getElementById('dateToday').textContent = 'Last Update: ' + dateString;
    }

    loadRaceData('OC300');
  </script>

</body>
</html>
